!function s(r,a,d){function l(t,e){if(!a[t]){if(!r[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(c)return c(t,!0);var i=new Error("Cannot find module '"+t+"'");throw i.code="MODULE_NOT_FOUND",i}var o=a[t]={exports:{}};r[t][0].call(o.exports,function(e){return l(r[t][1][e]||e)},o,o.exports,s,r,a,d)}return a[t].exports}for(var c="function"==typeof require&&require,e=0;e<d.length;e++)l(d[e]);return l}({1:[function(e,t,n){"use strict";window.getVPAIDAd=e("./vpaid")},{"./vpaid":2}],2:[function(e,t,n){"use strict";t.exports=function(){return window.tcVpaidObj={propValues:{},iframeEl:null,listeners:[],_vpjsListeners:[],_timerID:null,_comLink:!1,_slot:null,_videoSlot:null,_eventHistory:[],_log:function(e,t){console&&console.log&&console.log("TCClient:"+e,t)},appendMainScript:function(t,n){var e=document.createElement("script");e.type="text/javascript",e.src=t.mainURL+"?etag=1";var i=this;function o(e){window.TC.init({videoId:n.videoId||n.id||"sample",placementId:"default",elId:t.containerId,aspectRatio:n.aspr?Number(n.aspr):9/16,style:n.style,ytVideoId:n.ytVideoId,adToRun:n,showAd:!0,ed:n.ed,type:n.type,width:t.width,height:t.height,vpaid:!0}),console.log("init called"),e.iframeEl=document.getElementById("tc-iframe"+t.containerId),e._timerID=window.setInterval(function(){e._comLink?(e._log("Have _comLink so cancelling hello:"+e._comLink),window.clearInterval(e._timerID)):(e._log("Sending Hello to iframe"),e._sendMessage({method:"hello"}))},200)}e.readyState?e.onreadystatechange=function(){"loaded"!=e.readyState&&"complete"!=e.readyState||(e.onreadystatechange=null,o(i))}:e.onload=function(){o(i)},document.head.appendChild(e)},_init:function(e,t){this.appendMainScript(e,t);var o=this;window.addEventListener("message",function(e){try{var t,n,i;e&&e.data&&(t=e.data)&&t.indexOf&&-1<t.indexOf("_tcplayer_")&&(n=JSON.parse(t),o._comLink||(o._log("Have _comLink as received message from _tcplayer_:"+t),o._comLink=!0),n.command&&("setPropValues"==(i=n.command)?o.propValues=n:"event"==i?(o._log("Receiving message from tc player:"+t),o._fireEvent(n)):"hi"==i?o._log("Receiving hi message from tc player:"):o._log("Dont know how to handle command:"+i)))}catch(e){o._log("Error message receive:"+e)}})},_parseXML:function(e){var t;if(void 0!==window.DOMParser)t=function(e){return(new window.DOMParser).parseFromString(e,"text/xml")};else{if(void 0===window.ActiveXObject||!new window.ActiveXObject("Microsoft.XMLDOM"))throw this._log("No XML parser found"),new Error("No XML parser found");t=function(e){var t=new window.ActiveXObject("Microsoft.XMLDOM");return t.async="false",t.loadXML(e),t}}return t(e)},_getNodeValue:function(e,t){var n=e.documentElement.getElementsByTagName(t);if(0<n.length){var i=n[0];if(0<i.childNodes.length)return i.childNodes[0].nodeValue}return null},_getNodeAttribute:function(e,t){return e.getAttribute(t)},_getNodes:function(e,t){return e.documentElement.getElementsByTagName(t)},_getSpecificNodeValue:function(e){return e.childNodes[0].nodeValue},checkForAd:function(t){var e=new XMLHttpRequest,n=this;e.onreadystatechange=function(){if(4===this.readyState&&200===this.status)try{var e=JSON.parse(this.responseText.trim());e&&e.id?(e.isOutStream=!0,n._init(t,e)):console.error("error in fetching ad settings")}catch(e){console.error("error in fetching ad settings",e)}};var i=encodeURIComponent(window.location.hostname),o=encodeURIComponent(window.location.href.split("?")[0]);e.open("GET",t.vURL+"?&site="+i+"&purl="+o+"&ed="+t.ed,!0),e.send()},initAd:function(e,t,n,i,o,s){try{var r=s.slot;r||this._log("Container element not defined in environmentVars.slot"),this._log("initAd containerEl:"+r),this._slot=s.slot,s.videoSlot?this._videoSlot=s.videoSlot:this._log("Container element not defined in environmentVars.videoSlot");var a=o.AdParameters,d={};this._log("initAd adParams:"+a);var l=this._parseXML(a);d.mainURL=this._getNodeValue(l,"MainURL"),d.vURL=this._getNodeValue(l,"vURL"),d.ed=this._getNodeValue(l,"Ed"),d.width=e||"100%",d.height=t||"100%";var c=(d.containerEl=r).id;c||(r.id="tc-ad-slot-"+(new Date).getTime(),c=r.id),d.containerId=c,this.checkForAd(d)}catch(e){this._log("Exception on init:",e)}},resizeAd:function(e,t,n){this._sendMessage({method:"resizeAd",width:e,height:t,viewMode:n})},startAd:function(){this._sendMessage({method:"startAd"})},stopAd:function(){this._sendMessage({method:"stopAd"})},pauseAd:function(){this._sendMessage({method:"pauseAd"})},resumeAd:function(){this._sendMessage({method:"resumeAd"})},expandAd:function(){this._sendMessage({method:"expandAd"})},collapseAd:function(){this._sendMessage({method:"collapseAd"})},skipAd:function(){this._sendMessage({method:"skipAd"})},getAdLinear:function(){return this.propValues.AdLinear},getAdWidth:function(){var e=this.propValues.AdWidth;return this._log("getAdWidth:"+e),e},getAdHeight:function(){var e=this.propValues.AdHeight;return this._log("getAdHeight:"+e),e},getAdExpanded:function(){return this.propValues.AdExpanded},getAdSkippableState:function(){return this.propValues.AdSkippableState},getAdRemainingTime:function(){return this.propValues.AdRemainingTime},getAdDuration:function(){return this.propValues.AdDuration},getAdVolume:function(){var e=this.propValues.AdVolume;return this._log("getAdVolume:"+e),e},setAdVolume:function(e){this._log("setAdVolume:"+e),this._sendMessage({method:"setAdVolume",volume:e})},getAdCompanions:function(){return this.propValues.AdCompanions},getAdIcons:function(){return this.propValues.AdIcons},doGet:function(e){var t=document.createElement("img");return t.src=e,t.style.position="absolute",t.style.top="0",t.style.left="0",t.style.zIndex="-1",t.setAttribute("alt"," "),t},_sendMessage:function(e){if(this.iframeEl)try{e._tcplayer_="true";var t=JSON.stringify(e),n=this.iframeEl.contentWindow;n?n.postMessage(t,"*"):this._log("Error no child contentWindow found for jsonStr:"+t)}catch(e){this._log("Exception while sending message to child frame :"+t,e)}},_fireEvent:function(e){for(var t=e.type,n=0;n<this._vpjsListeners.length;n++){var i=this._vpjsListeners[n];if(i.eventName==t)try{i.listenerScope?i.fn.call(i.listenerScope):i.fn()}catch(e){this._log("Exception calling vpc listener function. funct:"+i.fn+" eventName:"+t,e)}}},subscribe:function(e,t,n){this._vpjsListeners.push({fn:e,eventName:t,listenerScope:n})},unsubscribe:function(e,t){for(var n=null,i=0;i<this._vpjsListeners.length;i++){var o=this._vpjsListeners[i];if(o.fn==e&&o.eventName==t){n=i;break}}null!=n?this._vpjsListeners.remove(n):this._log("unsubscribe, did not find listener to remove. fn:"+e+" eventName:"+t)},handshakeVersion:function(e){return this._log("handshake version is",e),!e||0!=e.indexOf("1")&&"2.0"!=e?"2.0":e},getPlayer:function(){return this._videoSlot},getSlot:function(){return this._slot},getPreviousEvents:function(){return this._eventHistory}},window.tcVpaidObj}},{}]},{},[1]);
//# sourceMappingURL=vpaid.js.map